function browse(){$.each(subjects,function(a,b){var c=$("#subj-list-template").clone().removeClass("hide").removeAttr("id").addClass("subj-"+a);c.find(".panel-title").text(b+" ("+a+")"),$("#subj-list").append(c)})}function fetchBySubj(k){$.ajax({url:"richmondAPI.php",jsonp:"callback",dataType:"jsonp",data:{subj:k},success:function(courseData){courseData=eval(courseData.response),$.getJSON("http://assets.richmond.edu/catalogs/courses.php?orderby=subjnum&archiveYear=2017&term=&catalogtype=ug&paginate=false&subj="+k+"&level=&keyword=&callback=?",function(a){a=a.courses,$.each(courseData,function(b,c){var d=$("#subj-list-template2").clone().removeAttr("id"),e=c["Course Number"];c["Course Number"]<=99&&(e="0"+c["Course Number"]),d=loadCourses(d,a,c,e).removeClass("hide"),$("#subj-list").find(".subj-"+k).find(".main-body").append(d)})})}})}function loadCourses(a,b,c,d){var e=b.substring(b.indexOf("</span>"+c.FOS+" "+d)),f=e.substring(0,e.indexOf("<!--close inner-content-wrap")),g=f.substring(c.FOS.length+9+c["Course Number"].length,f.indexOf("</a>")),h=f.substring(f.indexOf("Description</div>")+17);h=h.substring(0,h.indexOf("</div>"));var i=f.substring(f.indexOf("Units: ")+7,f.indexOf("</div>")),j=!0;if(g.indexOf("Print Courses")>-1&&(j=!1,g=c.Title,h="Course has no description",i="units are unknown"),f.indexOf("Prerequisites</div>")>-1){var k=f.substring(f.indexOf("Prerequisites</div>")+19);k=k.substring(0,k.indexOf("</div>"))}c.Title.indexOf("ST:")>-1||c.Title.indexOf("SP:")>-1||"FYS"===c.FOS||"WELL"===c.FOS||"HIST"===c.FOS&&"199"===c["Course Number"]||"HIST"===c.FOS&&"299"===c["Course Number"]||"ENGL"===c.FOS&&"299"===c["Course Number"]||"BIOL"===c.FOS&&"199"===c["Course Number"]||j&&(c.Title=g),"FYS"===c.FOS&&"description"in c?(g=c.displayTitle,h=c.description):"description"in c||(g=c.Title);var l="<h4>"+g+"</h4><p>"+h+"</p><p>Units: "+i+"</p>";void 0!==k&&(l=l+"<p>Prerequisites: "+k+"</p>"),a.find("#title").text(c.FOS+" "+c["Course Number"]+" | "+g),a.find(".panel-body").html(l),a.find("#button").attr("data-fos",c.FOS),a.find("#button").attr("data-coursenum",c["Course Number"]),a.find("#button").attr("data-coursename",c.Title),a.find("#button").attr("data-displayTitle",c.displayTitle);var m=!1;$.each(c.crns,function(a,b){crns.indexOf(b)>-1&&(m=!0)}),c.Available?m&&(a.find("#button").removeClass("btn-success"),a.find("#button").removeClass("btn-add-course"),a.find("#button").removeClass("glyphicon-plus"),a.find("#button").addClass("btn-disable"),a.find("#button").text("Preregistered")):(a.find("#button").removeClass("btn-success"),a.find("#button").removeClass("btn-add-course"),a.find("#button").removeClass("glyphicon-plus"),a.find("#button").addClass("btn-disable"),a.find("#button").text("Course Not Available"));var n=$("#course-basket, #course-basket-required").find("li");return n.each(function(){$(this).data("fos")===c.FOS&&$(this).data("coursenum")===parseInt(c["Course Number"])&&$(this).data("coursename")===c.Title&&(a.find("#button").removeClass("glyphicon-plus"),a.find("#button").removeClass("btn-success"),a.find("#button").removeClass("btn-add-course"),a.find("#button").addClass("btn-danger"),a.find("#button").addClass("glyphicon-minus"),a.find("#button").addClass("btn-remove-course"))}),a}function addCourse(a,b,c,d){var e=!0,f=$("#course-basket, #course-basket-required").find("li");if(f.each(function(){$(this).data("fos")===a&&$(this).data("coursenum")===b&&$(this).data("coursename")===c&&(e=!1)}),e){$("#search-results").find("button").each(function(){$(this).data("fos")===a&&$(this).data("coursenum")===b&&$(this).data("coursename")===c&&($(this).removeClass("glyphicon-plus"),$(this).removeClass("btn-success"),$(this).removeClass("btn-add-course"),$(this).addClass("btn-danger"),$(this).addClass("glyphicon-minus"),$(this).addClass("btn-remove-course"))}),$(".panel .panel-default button").each(function(){$(this).data("fos")===a&&$(this).data("coursenum")===b&&$(this).data("coursename")===c&&($(this).removeClass("glyphicon-plus"),$(this).removeClass("btn-success"),$(this).removeClass("btn-add-course"),$(this).addClass("btn-danger"),$(this).addClass("glyphicon-minus"),$(this).addClass("btn-remove-course"))});var g=$addedTemplate.clone(),h=$buttonRemoveTemplate.clone().removeClass("hide");g.removeClass("hide"),g.attr("id",""),g.text(a+" "+b+" | "+c),g.append("&nbsp; &nbsp; &nbsp; &nbsp;",h),g.attr("data-fos",a),g.attr("data-coursenum",b),g.attr("data-coursename",c),g.attr("data-displayTitle",d),$("#course-basket").append(g)}}var crns="";void 0!==$("#crns").val()&&$("#crns").val().length>0&&(crns=$("#crns").val().replace(/[,]+/g,"").replace(/ +(?= )/g,"").split(" "));var subjects={ACCT:"Accounting",AMST:"American Studies",ANTH:"Anthropology",ARAB:"Arabic",ARTH:"Art History",BIOL:"Biology",BMB:"Biochemistry",BUAD:"Business Administration",CHEM:"Chemistry",CHIN:"Chinese Program",CJ:"Criminal Justice",CLAC:"Cultures and Languages Across the Curriculum",CLCV:"Classical Studies",CLSC:"Classical Studies",CMSC:"Computer Science",DANC:"Dance",ECON:"Economics",EDUC:"Education",ENGL:"English",ENVR:"Environmental Studies",FIN:"Finance",FMST:"Film Studies",FREN:"French Program",FYS:"First Year Seminar",GEOG:"Geography",GERM:"German Studies Program",GREK:"Greek",HCS:"Healthcare Studies",HIST:"History",IBUS:"International Business",IDST:"Interdisciplinary Studies",IS:"International Studies",ITAL:"Italian Studies Program",JAPN:"Japanese Program",JOUR:"Journalism",JWST:"Jewish Studies",LAIS:"Latin American, Latino and Iberian Studies",LATN:"Latin",LDST:"Leadership Studies",LLC:"Languages, Literatures and Cultures",MATH:"Mathematics",MGMT:"Management",MKT:"Marketing",MSAP:"Music-Applied",MSCL:"Military Science and Leadership",MSEN:"Music-Ensemble",MUS:"Music",PHIL:"Philosophy",PHYS:"Physics",PLSC:"Political Science",PPEL:"Philosophy Politics Economics and Law",PSYC:"Psychology",RELG:"Religious Studies",RHCS:"Rhetoric and Communication Studies",RUSN:"Russian Studies Program",SDLC:"Languages, Literatures and Cultures",SOC:"Sociology",SPCS:"School of Professional and Continuing Studies",SWAH:"Languages, Literatures and Cultures",THTR:"Theatre",UNIV:"University Seminar",VMAP:"Visual and Media Arts Practice",WELL:"Wellness Program",WGSS:"Women, Gender and Sexuality Studies"};browse();var alreadyFetched=[];$(document).on("click",".collapse-btn",function(){var a=$(this).parent().attr("class").split(" ");a=a[a.length-1].split("-")[1],alreadyFetched.indexOf(a)===-1&&(fetchBySubj(a),alreadyFetched.push(a)),$(this).parent().find(".panel-collapse:not(.subj-list-collapse)").collapse("toggle")}),$(document).on("click",".collapse-btn-subj",function(){$(this).parent().parent().find(".panel-collapse").collapse("toggle")}),$(function(){$("#time-pref").bootstrapToggle({on:"Morning",off:"Afternoon",offstyle:"warning"}),$("#full-classes").bootstrapToggle({on:"Yes",off:"No",offstyle:"danger",onstyle:"success"})});var $defaultSearchResult=$("#searchResultTemplate"),$addedTemplate=$("#addedTemplate"),$buttonRemoveTemplate=$("#basket-remove");$(document).on("keyup","#searchField",function(){var loc=$("#searchField").val();""===loc&&$("#search-results").empty(),loc.length<3||$.ajax({url:"richmondAPI.php",jsonp:"callback",dataType:"jsonp",data:{search:loc},success:function(courseData){courseData=eval(courseData.response),$.each(courseData,function(a,b){var d,c=$defaultSearchResult.clone(),e=b["Course Number"];e<=99&&(e="0"+b["Course Number"]),d=e>99?b["Course Number"].substr(0,1)+"00":b["Course Number"],$.getJSON("http://assets.richmond.edu/catalogs/courses.php?orderby=subjnum&archiveYear=2017&term=&catalogtype=ug&paginate=false&subj="+b.FOS+"&level="+d+"&keyword=&callback=?",function(d){d=d.courses,c=loadCourses(c,d,b,e).removeAttr("id").removeClass("hide"),0===a&&$("#search-results").empty(),$("#search-results").append(c)})})}})}),$(document).on("click",".btn-generate",function(a){var b=$("#course-basket").find("li"),c=[],d=0;b.each(function(){var a={CourseNum:$(this).data("coursenum"),FOS:$(this).data("fos"),Title:$(this).data("coursename"),displayTitle:$(this).data("displaytitle")};c.push(a),d++}),b=$("#course-basket-required").find("li"),b.each(function(){var a={CourseNum:$(this).data("coursenum"),FOS:$(this).data("fos"),Title:$(this).data("coursename"),displayTitle:$(this).data("displaytitle"),requiredCourse:!0};c.push(a),d++});var e=[];$("#block").find(".blocked-time").each(function(){var a={};$(this).find("input, .time-display").each(function(){if(""!==$(this).text()&&void 0!==$(this).text()){var b=$(this).text().split(" - ");a.startTime=b[0],a.endTime=b[1]}$(this).is(":checked")&&(a[$(this).attr("name")]=$(this).attr("name"))}),e.push(a)});var f=$("#crns").val().replace(/\D+/g,",").split(",");c={allCourses:c,timePref:$("#time-pref").prop("checked"),fullClasses:$("#full-classes").prop("checked"),preregistered:f,startTime:$("#restrict-slider").text().split(" - ")[0],endTime:$("#restrict-slider").text().split(" - ")[1],unwantedTimes:e};var g=JSON.stringify(c);d>5&&window.alert("Trying to generate schedules with this many courses may take a long time, but I will try.\n\nThe calculation is allowed take up to 5 minutes, if it takes longer, it will fail."),console.log(g),window.location.assign("makeSchedule.php?i="+encodeURIComponent(g))}),$(document).on("click",".btn-jumbo-close",function(){$(this).parent().parent().hide(),document.cookie="jumbotron=hidden"}),$(document).on("click",".btn-remove-course",function(a){var b=$(a.target);void 0===b.data("fos")&&(b=b.parent());var c=b.data("fos"),d=b.data("coursenum"),e=b.data("coursename");$("#search-results").find("button").each(function(){$(this).data("fos")===c&&$(this).data("coursenum")===d&&$(this).data("coursename")===e&&($(this).addClass("glyphicon-plus"),$(this).addClass("btn-success"),$(this).addClass("btn-add-course"),$(this).removeClass("btn-danger"),$(this).removeClass("glyphicon-minus"),$(this).removeClass("btn-remove-course"))}),$(".panel .panel-default button").each(function(){$(this).data("fos")===c&&$(this).data("coursenum")===d&&$(this).data("coursename")===e&&($(this).addClass("glyphicon-plus"),$(this).addClass("btn-success"),$(this).addClass("btn-add-course"),$(this).removeClass("btn-danger"),$(this).removeClass("glyphicon-minus"),$(this).removeClass("btn-remove-course"))});var f=$("#course-basket").find("li").add("#course-basket-required li");f.each(function(){$(this).data("fos")===c&&$(this).data("coursenum")===d&&$(this).data("coursename")===e&&$(this).remove()})}),$(document).on("click",".btn-add-course",function(a){var b=$(a.target),c=b.data("fos"),d=b.data("coursenum"),e=b.data("coursename"),f=b.data("displaytitle");addCourse(c,d,e,f)});